ported by ryor, big thanks to snekky and cscarlet for help!
have fun <3